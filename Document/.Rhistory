<<<<<<< Updated upstream
=======
getSeason <- function(input.date){
numeric.date <- 100*month(input.date)+day(input.date)
## input Seasons upper limits in the form MMDD in the "break =" option:
cuts <- base::cut(numeric.date, breaks = c(0,319,0620,0921,1220,1231))
# rename the resulting groups (could've been done within cut(...levels=) if "Winter" wasn't double
levels(cuts) <- c("Winter","Spring","Summer","Fall","Winter")
return(cuts)
}
library(lubridate)
crimedate <- crime$START_DATE
crime$crimemonth<- month(as.POSIXlt(crimedate, format="%Y-%m-%dT%H:%M:%S.000Z"))
crime$crimeseason<- getSeason(as.POSIXlt(crimedate, format="%Y-%m-%dT%H:%M:%S.000Z"))
crime$crimemonth<- as.factor((crime$crimemonth))
summary(crime$crimemonth)
summary(crime$crimeseason)
seasonsummary=data.frame(A=c(7136,7892,9709,9046),B=c("Winter","Spring","Summer","Fall"))
ggplot(seasonsummary, aes(x = "", y = A, fill = B)) +
geom_bar(stat = "identity") +
coord_polar(theta = "y") +
xlab("Count") +
scale_fill_discrete(name = "Season")
#plot(crime$crimemonth)
season1=factor(crime$crimeseason,levels=c("Spring","Summer","Fall","Winter"))
colorbar1=c("green","red","yellow","blue")
ggplot() +
geom_bar(aes(x = crime$crimemonth, fill = crime$crimemonth)) +
xlab("Month") +
scale_fill_discrete(name = "Month")
ggplot() +
geom_bar(aes(x = crime$SHIFT, fill = crime$SHIFT)) +
xlab("SHIFT") +
scale_fill_discrete(name = "Shift")
summary(crime$SHIFT)
spring <- subset(crime,crimeseason=="Spring")
summer <- subset(crime,crimeseason=="Summer")
autumn <- subset(crime,crimeseason=="Autumn")
winter <- subset(crime,crimeseason=="Winter")
spof <- summary(spring$OFFENSE)
smof <- summary(summer$OFFENSE)
atof <- summary(autumn$OFFENSE)
wtaf <- summary(winter$OFFENSE)
summary(crime$SHIFT)
#plot(crime$SHIFT, col = c("red", "yellow", "blue"))
ggplot() +
geom_bar(aes(x = crime$OFFENSE, fill = crime$SHIFT)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("OFFENSE") +
scale_fill_discrete(name = "SHIFT")
ggplot() +
geom_bar(aes(x = crime$OFFENSE, fill = crime$crimeseason)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("Offense") +
scale_fill_discrete(name = "Season")
#ggplot() +
#  geom_bar(aes(x = crime1$METHOD, fill=crime1$OFFENSE)) +
#  scale_fill_discrete(name = "OFFENSE")+
#  xlab("Method")
contable2=table(crime$OFFENSE,crime$crimeseason)
chisq.test(contable2)
contable1=table(crime$OFFENSE,crime$SHIFT)
chisq.test(contable1)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
>>>>>>> Stashed changes
# can add quietly=T option to the require() function
loadPkg = function(x) { if (!require(x,character.only=T, quietly =T)) { install.packages(x,dep=T,repos="http://cran.us.r-project.org"); if(!require(x,character.only=T)) stop("Package not found") } }
knitr::opts_chunk$set(echo = TRUE)
# Load the library
<<<<<<< Updated upstream
library(maptools)
library(sf)
library(sp)
=======
>>>>>>> Stashed changes
library(ggplot2)
library(dplyr)
# Load the dataset
crime <- read.csv("../DataSet/Crime_Incidents_in_2018.csv")
<<<<<<< Updated upstream
crimeWashingtonDC <- st_read("../DataSet/Crime_Incidents_in_2018/Crime_Incidents_in_2018.shp")
#crimeWashingtonDC <- na.omit(crimeWashingtonDC)
DCDistrict <- st_read("../DataSet/Police_Districts/Police_Districts.shp")
nrow(crime)
# Load the color
districtColors <- c("purple", "springgreen", "yellow", "brown", "navy", "red", "blue")
typeColors <- c("purple", "springgreen", "yellow", "brown", "navy", "red", "blue", "black", "pink")
=======
# can add quietly=T option to the require() function
loadPkg = function(x) { if (!require(x,character.only=T, quietly =T)) { install.packages(x,dep=T,repos="http://cran.us.r-project.org"); if(!require(x,character.only=T)) stop("Package not found") } }
knitr::opts_chunk$set(echo = TRUE)
# Load the library
library(ggplot2)
library(dplyr)
# Load the dataset
crime <- read.csv("../DataSet/Crime_Incidents_in_2018.csv")
knitr::opts_chunk$set(echo = TRUE)
# Load the library
library(ggplot2)
# Load the dataset
crime <- read.csv("../DataSet/Crime_Incidents_in_2018.csv")
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
crimeOffense <- subset(crime, select = 'OFFENSE')
crimeTimeAndOffense<- cbind(crimeTime, crimeOffense)
crimeTimeAndOffense <- subset(crimeTimeAndOffense, (Time_Difference <= 10000 & Time_Difference >= 0))
head(crimeTimeAndOffense)
anovaCrimeTaO <- aov(Time_Difference~OFFENSE, data = crimeTimeAndOffense)
anovaCrimeTaO
summary(anovaCrimeTaO)
p <- ggplot(crimeTimeAndOffense, aes(x=OFFENSE, y=Time_Difference, color = OFFENSE)) +
ggtitle("boxplot of Time with Offense") +
geom_boxplot()
p + scale_x_discrete(breaks = levels(crimeTimeAndOffense$OFFENSE), labels = c('ARS','AW/DW','BUR','HOM','MOT','ROB','SA','TF/A','T/O'))
anovaCrimeTaD <- aov(Time_Difference~DISTRICT, data = crimeTimeAndDistrict)
crimeDistrict <- subset(crime, select = 'DISTRICT')
crimeTimeAndDistrict <- cbind(crimeTime, crimeDistrict)
crimeTimeAndDistrict <- na.omit(crimeTimeAndDistrict)
crimeTimeAndDistrict <- subset(crimeTimeAndDistrict, (Time_Difference <= 10000 & Time_Difference >= 0))
crimeTimeAndDistrict$DISTRICT <- as.factor(crimeTimeAndDistrict$DISTRICT)
ggplot(crimeTimeAndDistrict, aes(x=DISTRICT, y=Time_Difference, color = DISTRICT)) +
ggtitle("boxplot of Time with District") +
geom_boxplot()
crimeShift <- subset(crime, select = 'SHIFT')
crimeTimeAndShift<- cbind(crimeTime, crimeShift)
crimeTimeAndShift <- subset(crimeTimeAndShift, (Time_Difference <= 10000 & Time_Difference >= 0))
ggplot(crimeTimeAndShift, aes(x=SHIFT, y=Time_Difference, color = SHIFT)) +
ggtitle("boxplot of Time with Shift") +
geom_boxplot()
anovaCrimeTaS <- aov(Time_Difference~SHIFT, data = crimeTimeAndShift)
anovaCrimeTaS
summary(anovaCrimeTaS)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
crimeOffense <- subset(crime, select = 'OFFENSE')
crimeTimeAndOffense<- cbind(crimeTime, crimeOffense)
crimeTimeAndOffense <- subset(crimeTimeAndOffense, (Time_Difference <= 10000 & Time_Difference >= 0))
head(crimeTimeAndOffense)
anovaCrimeTaO <- aov(Time_Difference~OFFENSE, data = crimeTimeAndOffense)
anovaCrimeTaO
summary(anovaCrimeTaO)
p <- ggplot(crimeTimeAndOffense, aes(x=OFFENSE, y=Time_Difference, color = OFFENSE)) +
ggtitle("boxplot of Time with Offense") +
geom_boxplot()
p + scale_x_discrete(breaks = levels(crimeTimeAndOffense$OFFENSE), labels = c('ARS','AW/DW','BUR','HOM','MOT','ROB','SA','TF/A','T/O'))
anovaCrimeTaD <- aov(Time_Difference~DISTRICT, data = crimeTimeAndDistrict)
anovaCrimeTaD
summary(anovaCrimeTaD)
crimeDistrict <- subset(crime, select = 'DISTRICT')
crimeTimeAndDistrict <- cbind(crimeTime, crimeDistrict)
crimeTimeAndDistrict <- na.omit(crimeTimeAndDistrict)
crimeTimeAndDistrict <- subset(crimeTimeAndDistrict, (Time_Difference <= 10000 & Time_Difference >= 0))
crimeTimeAndDistrict$DISTRICT <- as.factor(crimeTimeAndDistrict$DISTRICT)
ggplot(crimeTimeAndDistrict, aes(x=DISTRICT, y=Time_Difference, color = DISTRICT)) +
ggtitle("boxplot of Time with District") +
geom_boxplot()
crimeShift <- subset(crime, select = 'SHIFT')
crimeTimeAndShift<- cbind(crimeTime, crimeShift)
crimeTimeAndShift <- subset(crimeTimeAndShift, (Time_Difference <= 10000 & Time_Difference >= 0))
ggplot(crimeTimeAndShift, aes(x=SHIFT, y=Time_Difference, color = SHIFT)) +
ggtitle("boxplot of Time with Shift") +
geom_boxplot()
knitr::opts_chunk$set(echo = TRUE)
crime <- read.csv("../Dataset/Crime_Incidents_in_2018.csv")
crime <- data.frame(crime)
library(ggplot2)
>>>>>>> Stashed changes
library(lubridate)
getSeason <- function(input.date){
numeric.date <- 100*month(input.date)+day(input.date)
## input Seasons upper limits in the form MMDD in the "break =" option:
cuts <- base::cut(numeric.date, breaks = c(0,319,0620,0921,1220,1231))
# rename the resulting groups (could've been done within cut(...levels=) if "Winter" wasn't double
levels(cuts) <- c("Winter","Spring","Summer","Fall","Winter")
return(cuts)
}
<<<<<<< Updated upstream
library(dplyr)
crime1<-subset(crime,METHOD=="GUN"|METHOD=="KNIFE",select=c(OFFENSE,METHOD))
crime1$OFFENSE<- factor(crime1$OFFENSE)
crime1$METHOD<- factor(crime1$METHOD)
summary(crime$OFFENSE)
library(ggplot2)
crime1$OFFENSE<- factor(crime1$OFFENSE)
crime1$METHOD<- factor(crime1$METHOD)
#lbs=c("Arson","Assault/Dangerous Weapon","Burglary","Homicide","MotorTheft","Robbery","Sexabuse","Theft/auto","Theft/other")
# plot(crime$OFFENSE,las=2)
library(ggplot2)
p <- ggplot()
p + geom_bar(aes(x = crime$OFFENSE, fill = crime$OFFENSE)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("OFFENSE") +
ggtitle("Types of crime") +
scale_fill_discrete(name = "OFFENSE") +
labs(color = "OFFENSE")
summary(crime$METHOD)
cper=nrow(crime1)/nrow(crime)
#rime$weapon <- matrix(crime$METHOD!='OTHERS') *1
contable = table(crime$OFFENSE, crime$METHOD)
contable
gun <- subset(crime,METHOD=="GUN",select=c(OFFENSE,METHOD))
knife <- subset(crime,METHOD=="KNIFE",select=c(OFFENSE,METHOD))
ggplot() +
geom_bar(aes(x = crime1$OFFENSE, fill=crime1$METHOD), position = 'dodge') +
scale_x_discrete(labels = c("ARS", "BUR", "HOM", "ROB", "SA", "T/O")) +
scale_fill_discrete(name = "Method")+
ggtitle("Crime with weapons")
xlab("Offense")
ggplot() +
geom_sf(data = DCDistrict, aes(fill = factor(DISTRICT))) +
scale_fill_discrete(name = "District") +
ggtitle("Police districts in DC") +
coord_sf()
crimeDistribution <- subset(crime, select = c(DISTRICT, OFFENSE))
crimeDistribution <- na.omit(crimeDistribution)
ggplot(crimeDistribution, aes(DISTRICT, fill = OFFENSE)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(breaks = seq(1,7,1), labels = c("D1","D2","D3","D4","D5","D6","D7"))+
ggtitle("Barplot of crime types in each districts")
crimeMap <- subset(crimeWashingtonDC, select = c(DISTRICT, LATITUDE, LONGITUDE))
crimeMap <- na.omit(crimeMap)
# levels(crimeWashingtonDC$DISTRICT)
# names(DCDistrict)
# DCDistrict
# levels(DCDistrict$DISTRICT)
# st_geometry_type(DCDistrict)
ggplot() +
geom_sf(data = DCDistrict) +
geom_sf(data = crimeMap, aes(color = DISTRICT), size = 1) +
scale_color_manual(values = districtColors) +
labs(color = 'District') +
ggtitle("Crime distribution") +
coord_sf()
#ggplot() +
# geom_sf(data = WashingtonDC, aes(color = DISTRICT), size = 1) +
#scale_color_manual(values = colors) +
#ggtitle("test") +
#coord_sf()
# plot(x)
# names(crimeWashingtonDC)
# levels(crimeWashingtonDC$OFFENSE)
DCDistrict1 <- subset(DCDistrict, DISTRICT == 1)
crimeDistrict1 <- subset(crimeWashingtonDC, DISTRICT == 1)
ggplot() +
geom_sf(data = DCDistrict1) +
geom_sf(data = crimeDistrict1, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(color = 'Offense') +
ggtitle("District 1") +
coord_sf()
DCDistrict2 <- subset(DCDistrict, DISTRICT == 2)
crimeDistrict2 <- subset(crimeWashingtonDC, DISTRICT == 2)
ggplot() +
geom_sf(data = DCDistrict2) +
geom_sf(data = crimeDistrict2, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(color = 'Offense') +
ggtitle("District 2") +
coord_sf()
DCDistrict3 <- subset(DCDistrict, DISTRICT == 3)
crimeDistrict3 <- subset(crimeWashingtonDC, DISTRICT == 3)
ggplot() +
geom_sf(data = DCDistrict3) +
geom_sf(data = crimeDistrict3, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(color = 'Offense') +
ggtitle("District 3") +
coord_sf()
DCDistrict4 <- subset(DCDistrict, DISTRICT == 4)
crimeDistrict4 <- subset(crimeWashingtonDC, DISTRICT == 4)
ggplot() +
geom_sf(data = DCDistrict4) +
geom_sf(data = crimeDistrict4, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(color = 'Offense') +
ggtitle("District 4") +
coord_sf()
DCDistrict5 <- subset(DCDistrict, DISTRICT == 5)
crimeDistrict5 <- subset(crimeWashingtonDC, DISTRICT == 5)
ggplot() +
geom_sf(data = DCDistrict5) +
geom_sf(data = crimeDistrict5, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(color = 'Offense') +
ggtitle("District 5") +
coord_sf()
DCDistrict6 <- subset(DCDistrict, DISTRICT == 6)
crimeDistrict6 <- subset(crimeWashingtonDC, DISTRICT == 6)
ggplot() +
geom_sf(data = DCDistrict6) +
geom_sf(data = crimeDistrict6, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(col = 'Offense') +
ggtitle("District 6") +
coord_sf()
DCDistrict7 <- subset(DCDistrict, DISTRICT == 7)
crimeDistrict7 <- subset(crimeWashingtonDC, DISTRICT == 7)
ggplot() +
geom_sf(data = DCDistrict7) +
geom_sf(data = crimeDistrict7, aes(color = OFFENSE), size = 1) +
scale_color_manual(values = typeColors) +
labs(col = 'Offense') +
ggtitle("District 7") +
coord_sf()
crimeDistribution$DISTRICT <- as.factor(crimeDistribution$DISTRICT)
contable <- table(crimeDistribution$DISTRICT, crimeDistribution$OFFENSE)
chisq.test(contable)
# levels(crimeWashingtonDC$METHOD)
crimeWithGun <- subset(crimeWashingtonDC, METHOD == 'GUN', select = c(METHOD, LATITUDE, LONGITUDE ))
ggplot() +
geom_sf(data = DCDistrict) +
geom_sf(data = crimeWithGun,col = '#FF4040',  size = 1) +
ggtitle("GUN crime") +
coord_sf()
=======
library(lubridate)
crimedate <- crime$START_DATE
crime$crimemonth<- month(as.POSIXlt(crimedate, format="%Y-%m-%dT%H:%M:%S.000Z"))
crime$crimeseason<- getSeason(as.POSIXlt(crimedate, format="%Y-%m-%dT%H:%M:%S.000Z"))
crime$crimemonth<- as.factor((crime$crimemonth))
summary(crime$crimemonth)
summary(crime$crimeseason)
seasonsummary=data.frame(A=c(7136,7892,9709,9046),B=c("Winter","Spring","Summer","Fall"))
ggplot(seasonsummary, aes(x = "", y = A, fill = B)) +
geom_bar(stat = "identity") +
coord_polar(theta = "y") +
xlab("Count") +
scale_fill_discrete(name = "Season")
#plot(crime$crimemonth)
season1=factor(crime$crimeseason,levels=c("Spring","Summer","Fall","Winter"))
colorbar1=c("green","red","yellow","blue")
ggplot() +
geom_bar(aes(x = crime$crimemonth, fill = crime$crimemonth)) +
xlab("Month") +
scale_fill_discrete(name = "Month")
ggplot() +
geom_bar(aes(x = crime$SHIFT, fill = crime$SHIFT)) +
xlab("SHIFT") +
scale_fill_discrete(name = "Shift")
summary(crime$SHIFT)
spring <- subset(crime,crimeseason=="Spring")
summer <- subset(crime,crimeseason=="Summer")
autumn <- subset(crime,crimeseason=="Autumn")
winter <- subset(crime,crimeseason=="Winter")
spof <- summary(spring$OFFENSE)
smof <- summary(summer$OFFENSE)
atof <- summary(autumn$OFFENSE)
wtaf <- summary(winter$OFFENSE)
summary(crime$SHIFT)
#plot(crime$SHIFT, col = c("red", "yellow", "blue"))
ggplot() +
geom_bar(aes(x = crime$OFFENSE, fill = crime$SHIFT)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("OFFENSE") +
scale_fill_discrete(name = "SHIFT")
ggplot() +
geom_bar(aes(x = crime$OFFENSE, fill = crime$crimeseason)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("Offense") +
scale_fill_discrete(name = "Season")
#ggplot() +
#  geom_bar(aes(x = crime1$METHOD, fill=crime1$OFFENSE)) +
#  scale_fill_discrete(name = "OFFENSE")+
#  xlab("Method")
contable2=table(crime$OFFENSE,crime$crimeseason)
chisq.test(contable2)
contable1=table(crime$OFFENSE,crime$SHIFT)
chisq.test(contable1)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
crimeOffense <- subset(crime, select = 'OFFENSE')
crimeTimeAndOffense<- cbind(crimeTime, crimeOffense)
crimeTimeAndOffense <- subset(crimeTimeAndOffense, (Time_Difference <= 10000 & Time_Difference >= 0))
head(crimeTimeAndOffense)
anovaCrimeTaO <- aov(Time_Difference~OFFENSE, data = crimeTimeAndOffense)
anovaCrimeTaO
summary(anovaCrimeTaO)
p <- ggplot(crimeTimeAndOffense, aes(x=OFFENSE, y=Time_Difference, color = OFFENSE)) +
ggtitle("boxplot of Time with Offense") +
geom_boxplot()
p + scale_x_discrete(breaks = levels(crimeTimeAndOffense$OFFENSE), labels = c('ARS','AW/DW','BUR','HOM','MOT','ROB','SA','TF/A','T/O'))
anovaCrimeTaD <- aov(Time_Difference~DISTRICT, data = crimeTimeAndDistrict)
anovaCrimeTaD
summary(anovaCrimeTaD)
crimeDistrict <- subset(crime, select = 'DISTRICT')
crimeTimeAndDistrict <- cbind(crimeTime, crimeDistrict)
crimeTimeAndDistrict <- na.omit(crimeTimeAndDistrict)
crimeTimeAndDistrict <- subset(crimeTimeAndDistrict, (Time_Difference <= 10000 & Time_Difference >= 0))
crimeTimeAndDistrict$DISTRICT <- as.factor(crimeTimeAndDistrict$DISTRICT)
ggplot(crimeTimeAndDistrict, aes(x=DISTRICT, y=Time_Difference, color = DISTRICT)) +
ggtitle("boxplot of Time with District") +
geom_boxplot()
crimeShift <- subset(crime, select = 'SHIFT')
crimeTimeAndShift<- cbind(crimeTime, crimeShift)
crimeTimeAndShift <- subset(crimeTimeAndShift, (Time_Difference <= 10000 & Time_Difference >= 0))
ggplot(crimeTimeAndShift, aes(x=SHIFT, y=Time_Difference, color = SHIFT)) +
ggtitle("boxplot of Time with Shift") +
geom_boxplot()
anovaCrimeTaD <- aov(Time_Difference~DISTRICT, data = crimeTimeAndDistrict)
anovaCrimeTaD
summary(anovaCrimeTaD)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
crimeOffense <- subset(crime, select = 'OFFENSE')
crimeTimeAndOffense<- cbind(crimeTime, crimeOffense)
crimeTimeAndOffense <- subset(crimeTimeAndOffense, (Time_Difference <= 10000 & Time_Difference >= 0))
head(crimeTimeAndOffense)
anovaCrimeTaO <- aov(Time_Difference~OFFENSE, data = crimeTimeAndOffense)
anovaCrimeTaO
summary(anovaCrimeTaO)
p <- ggplot(crimeTimeAndOffense, aes(x=OFFENSE, y=Time_Difference, color = OFFENSE)) +
ggtitle("boxplot of Time with Offense") +
geom_boxplot()
p + scale_x_discrete(breaks = levels(crimeTimeAndOffense$OFFENSE), labels = c('ARS','AW/DW','BUR','HOM','MOT','ROB','SA','TF/A','T/O'))
anovaCrimeTaD <- aov(Time_Difference~DISTRICT, data = crimeTimeAndDistrict)
anovaCrimeTaD
summary(anovaCrimeTaD)
crimeDistrict <- subset(crime, select = 'DISTRICT')
crimeTimeAndDistrict <- cbind(crimeTime, crimeDistrict)
crimeTimeAndDistrict <- na.omit(crimeTimeAndDistrict)
crimeTimeAndDistrict <- subset(crimeTimeAndDistrict, (Time_Difference <= 10000 & Time_Difference >= 0))
crimeTimeAndDistrict$DISTRICT <- as.factor(crimeTimeAndDistrict$DISTRICT)
ggplot(crimeTimeAndDistrict, aes(x=DISTRICT, y=Time_Difference, color = DISTRICT)) +
ggtitle("boxplot of Time with District") +
geom_boxplot()
crimeShift <- subset(crime, select = 'SHIFT')
crimeTimeAndShift<- cbind(crimeTime, crimeShift)
crimeTimeAndShift <- subset(crimeTimeAndShift, (Time_Difference <= 10000 & Time_Difference >= 0))
ggplot(crimeTimeAndShift, aes(x=SHIFT, y=Time_Difference, color = SHIFT)) +
ggtitle("boxplot of Time with Shift") +
geom_boxplot()
anovaCrimeTaS <- aov(Time_Difference~SHIFT, data = crimeTimeAndShift)
anovaCrimeTaS
summary(anovaCrimeTaS)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
tukeyAoV <- TukeyHSD(anovaCrimeTaO)
tukeyAoV
tukeyAoV <- TukeyHSD(anovaCrimeTaS)
tukeyAoV
p <- ggplot(crimeTimeAndOffense, aes(x=OFFENSE, y=Time_Difference, color = OFFENSE)) +
ggtitle("boxplot of Time with Offense") +
geom_boxplot()
p + scale_x_discrete(breaks = levels(crimeTimeAndOffense$OFFENSE), labels = c('ARS','AW/DW','BUR','HOM','MOT','ROB','SA','TF/A','T/O'))
anovaCrimeTaS <- aov(Time_Difference~SHIFT, data = crimeTimeAndShift)
anovaCrimeTaS
summary(anovaCrimeTaS)
tukeyAoV <- TukeyHSD(anovaCrimeTaS)
tukeyAoV
tukeyAoV <- TukeyHSD(anovaCrimeTaS)
tukeyAoV
knitr::opts_chunk$set(echo = TRUE)
crime <- read.csv("../Dataset/Crime_Incidents_in_2018.csv")
crime <- data.frame(crime)
library(ggplot2)
library(lubridate)
getSeason <- function(input.date){
numeric.date <- 100*month(input.date)+day(input.date)
## input Seasons upper limits in the form MMDD in the "break =" option:
cuts <- base::cut(numeric.date, breaks = c(0,319,0620,0921,1220,1231))
# rename the resulting groups (could've been done within cut(...levels=) if "Winter" wasn't double
levels(cuts) <- c("Winter","Spring","Summer","Fall","Winter")
return(cuts)
}
>>>>>>> Stashed changes
library(lubridate)
crimedate <- crime$START_DATE
crime$crimemonth<- month(as.POSIXlt(crimedate, format="%Y-%m-%dT%H:%M:%S.000Z"))
crime$crimeseason<- getSeason(as.POSIXlt(crimedate, format="%Y-%m-%dT%H:%M:%S.000Z"))
crime$crimemonth<- as.factor((crime$crimemonth))
summary(crime$crimemonth)
summary(crime$crimeseason)
seasonsummary=data.frame(A=c(7136,7892,9709,9046),B=c("Winter","Spring","Summer","Fall"))
ggplot(seasonsummary, aes(x = "", y = A, fill = B)) +
geom_bar(stat = "identity") +
coord_polar(theta = "y") +
xlab("Count") +
<<<<<<< Updated upstream
ggtitle("Crimes in different seasons") +
scale_fill_discrete(name = "Season")
summary(crime$crimeseason)
=======
scale_fill_discrete(name = "Season")
>>>>>>> Stashed changes
#plot(crime$crimemonth)
season1=factor(crime$crimeseason,levels=c("Spring","Summer","Fall","Winter"))
colorbar1=c("green","red","yellow","blue")
ggplot() +
geom_bar(aes(x = crime$crimemonth, fill = crime$crimemonth)) +
xlab("Month") +
<<<<<<< Updated upstream
ggtitle("Crimes in different month") +
scale_fill_discrete(name = "Month")
summary(crime$crimemonth)
ggplot() +
geom_bar(aes(x = crime$SHIFT, fill = crime$SHIFT)) +
xlab("SHIFT") +
ggtitle("Crimes in different shifts") +
=======
scale_fill_discrete(name = "Month")
ggplot() +
geom_bar(aes(x = crime$SHIFT, fill = crime$SHIFT)) +
xlab("SHIFT") +
>>>>>>> Stashed changes
scale_fill_discrete(name = "Shift")
summary(crime$SHIFT)
spring <- subset(crime,crimeseason=="Spring")
summer <- subset(crime,crimeseason=="Summer")
autumn <- subset(crime,crimeseason=="Autumn")
winter <- subset(crime,crimeseason=="Winter")
spof <- summary(spring$OFFENSE)
smof <- summary(summer$OFFENSE)
atof <- summary(autumn$OFFENSE)
wtaf <- summary(winter$OFFENSE)
summary(crime$SHIFT)
#plot(crime$SHIFT, col = c("red", "yellow", "blue"))
ggplot() +
geom_bar(aes(x = crime$OFFENSE, fill = crime$SHIFT)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("OFFENSE") +
scale_fill_discrete(name = "SHIFT")
ggplot() +
geom_bar(aes(x = crime$OFFENSE, fill = crime$crimeseason)) +
scale_x_discrete(labels = c("ARS", "AW/DW", "BUR", "HOM", "MOT", "ROB", "SA", "TF/A", "T/O")) +
xlab("Offense") +
scale_fill_discrete(name = "Season")
#ggplot() +
#  geom_bar(aes(x = crime1$METHOD, fill=crime1$OFFENSE)) +
#  scale_fill_discrete(name = "OFFENSE")+
#  xlab("Method")
contable2=table(crime$OFFENSE,crime$crimeseason)
chisq.test(contable2)
<<<<<<< Updated upstream
#summary(chisq.test(contable2))
=======
>>>>>>> Stashed changes
contable1=table(crime$OFFENSE,crime$SHIFT)
chisq.test(contable1)
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- crimeTime %>%
mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
crimeTime$Time_Difference <- as.numeric(crimeTime$Time_Difference)
head(crimeTime)
crimeOffense <- subset(crime, select = 'OFFENSE')
crimeTimeAndOffense<- cbind(crimeTime, crimeOffense)
crimeTimeAndOffense <- subset(crimeTimeAndOffense, (Time_Difference <= 10000 & Time_Difference >= 0))
head(crimeTimeAndOffense)
p <- ggplot(crimeTimeAndOffense, aes(x=OFFENSE, y=Time_Difference, color = OFFENSE)) +
<<<<<<< Updated upstream
ggtitle("Boxplot of Time with Offense") +
=======
ggtitle("boxplot of Time with Offense") +
>>>>>>> Stashed changes
geom_boxplot()
p + scale_x_discrete(breaks = levels(crimeTimeAndOffense$OFFENSE), labels = c('ARS','AW/DW','BUR','HOM','MOT','ROB','SA','TF/A','T/O'))
anovaCrimeTaO <- aov(Time_Difference~OFFENSE, data = crimeTimeAndOffense)
anovaCrimeTaO
summary(anovaCrimeTaO)
<<<<<<< Updated upstream
tukeyAoV <- TukeyHSD(anovaCrimeTaO)
tukeyAoV
=======
anovaCrimeTaD <- aov(Time_Difference~DISTRICT, data = crimeTimeAndDistrict)
anovaCrimeTaD
summary(anovaCrimeTaD)
tukeyAoV <- TukeyHSD(anovaCrimeTaD)
tukeyAoV
anovaCrimeTaO <- aov(Time_Difference~OFFENSE, data = crimeTimeAndOffense)
anovaCrimeTaO
summary(anovaCrimeTaO)
tukeyAoV <- TukeyHSD(anovaCrimeTaD)
tukeyAoV
tukeyAoV <- TukeyHSD(anovaCrimeTaD)
tukeyAoV
tukeyAoV <- TukeyHSD(anovaCrimeTaO)
tukeyAoV
crimeTime <- subset(crime, select = c(REPORT_DAT, START_DATE))
# levels(crimeTime$REPORT_DAT)
# crimeTime
# strptime(crime$REPORT_DAT[1],format = "%Y-%m-%d %H:%M:%S")
crimeTime$REPORT_DAT <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$REPORT_DAT))))
#crimeTime$REPORT_DAT <- gsub("T"," ", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- gsub(".000Z","", crimeTime$REPORT_DAT)
#crimeTime$REPORT_DAT <- as.POSIXct(crimeTime$REPORT_DAT)
crimeTime$START_DATE <- as.POSIXct(gsub(".000Z", "", gsub("T", " ", as.character(crimeTime$START_DATE))))
crimeTime <- mutate(Time_Difference = difftime(REPORT_DAT, START_DATE))
detach("package:dplyr", unload = TRUE)
library(dplyr)
contable2=table(crime$OFFENSE,crime$crimeseason)
chisq.test(contable2)
summary(chisq.test(contable2))
>>>>>>> Stashed changes
